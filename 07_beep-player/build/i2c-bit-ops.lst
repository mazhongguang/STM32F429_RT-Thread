ARM GAS  /tmp/ccNhsg46.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"i2c-bit-ops.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.i2c_start,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	i2c_start:
  25              	.LFB22:
  26              		.file 1 "rt-thread/components/drivers/i2c/i2c-bit-ops.c"
   1:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** /*
   2:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * Copyright (c) 2006-2018, RT-Thread Development Team
   3:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  *
   4:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * SPDX-License-Identifier: Apache-2.0
   5:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  *
   6:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * Change Logs:
   7:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * Date           Author        Notes
   8:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * 2012-04-25     weety         first version
   9:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  */
  10:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  11:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #include <rtdevice.h>
  12:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  13:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define DBG_TAG               "I2C"
  14:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #ifdef RT_I2C_BITOPS_DEBUG
  15:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define DBG_LVL               DBG_LOG
  16:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #else
  17:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define DBG_LVL               DBG_INFO
  18:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #endif
  19:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #include <rtdbg.h>
  20:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  21:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define SET_SDA(ops, val)   ops->set_sda(ops->data, val)
  22:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define SET_SCL(ops, val)   ops->set_scl(ops->data, val)
  23:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define GET_SDA(ops)        ops->get_sda(ops->data)
  24:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define GET_SCL(ops)        ops->get_scl(ops->data)
  25:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  26:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** rt_inline void i2c_delay(struct rt_i2c_bit_ops *ops)
  27:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     ops->udelay((ops->delay_us + 1) >> 1);
  29:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  30:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  31:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** rt_inline void i2c_delay2(struct rt_i2c_bit_ops *ops)
  32:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
ARM GAS  /tmp/ccNhsg46.s 			page 2


  33:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     ops->udelay(ops->delay_us);
  34:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  35:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  36:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define SDA_L(ops)          SET_SDA(ops, 0)
  37:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define SDA_H(ops)          SET_SDA(ops, 1)
  38:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #define SCL_L(ops)          SET_SCL(ops, 0)
  39:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  40:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** /**
  41:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  * release scl line, and wait scl line to high.
  42:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****  */
  43:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_err_t SCL_H(struct rt_i2c_bit_ops *ops)
  44:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
  45:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_tick_t start;
  46:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  47:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SET_SCL(ops, 1);
  48:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  49:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (!ops->get_scl)
  50:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         goto done;
  51:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  52:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     start = rt_tick_get();
  53:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     while (!GET_SCL(ops))
  54:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
  55:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((rt_tick_get() - start) > ops->timeout)
  56:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_ETIMEOUT;
  57:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         rt_thread_delay((ops->timeout + 1) >> 1);
  58:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
  59:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #ifdef RT_I2C_BITOPS_DEBUG
  60:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (rt_tick_get() != start)
  61:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
  62:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_D("wait %ld tick for SCL line to go high",
  63:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****               rt_tick_get() - start);
  64:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
  65:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #endif
  66:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  67:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** done:
  68:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
  69:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  70:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return RT_EOK;
  71:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  72:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  73:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static void i2c_start(struct rt_i2c_bit_ops *ops)
  74:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
  27              		.loc 1 74 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              	.LVL0:
  32 0000 10B5     		push	{r4, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 4, -8
  36              		.cfi_offset 14, -4
  37 0002 0446     		mov	r4, r0
  75:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #ifdef RT_I2C_BITOPS_DEBUG
  76:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (ops->get_scl && !GET_SCL(ops))
  77:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
  78:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_E("I2C bus error, SCL line low");
ARM GAS  /tmp/ccNhsg46.s 			page 3


  79:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
  80:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (ops->get_sda && !GET_SDA(ops))
  81:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
  82:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_E("I2C bus error, SDA line low");
  83:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
  84:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** #endif
  85:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_L(ops);
  38              		.loc 1 85 0
  39 0004 4368     		ldr	r3, [r0, #4]
  40 0006 0021     		movs	r1, #0
  41 0008 0068     		ldr	r0, [r0]
  42              	.LVL1:
  43 000a 9847     		blx	r3
  44              	.LVL2:
  45              	.LBB30:
  46              	.LBB31:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  47              		.loc 1 28 0
  48 000c 6369     		ldr	r3, [r4, #20]
  49 000e A069     		ldr	r0, [r4, #24]
  50 0010 0130     		adds	r0, r0, #1
  51 0012 4008     		lsrs	r0, r0, #1
  52 0014 9847     		blx	r3
  53              	.LVL3:
  54              	.LBE31:
  55              	.LBE30:
  86:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
  87:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_L(ops);
  56              		.loc 1 87 0
  57 0016 A368     		ldr	r3, [r4, #8]
  58 0018 0021     		movs	r1, #0
  59 001a 2068     		ldr	r0, [r4]
  60 001c 9847     		blx	r3
  61              	.LVL4:
  62 001e 10BD     		pop	{r4, pc}
  63              		.cfi_endproc
  64              	.LFE22:
  66              		.section	.text.SCL_H,"ax",%progbits
  67              		.align	1
  68              		.syntax unified
  69              		.thumb
  70              		.thumb_func
  71              		.fpu fpv4-sp-d16
  73              	SCL_H:
  74              	.LFB21:
  44:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_tick_t start;
  75              		.loc 1 44 0
  76              		.cfi_startproc
  77              		@ args = 0, pretend = 0, frame = 0
  78              		@ frame_needed = 0, uses_anonymous_args = 0
  79              	.LVL5:
  80 0000 38B5     		push	{r3, r4, r5, lr}
  81              	.LCFI1:
  82              		.cfi_def_cfa_offset 16
  83              		.cfi_offset 3, -16
  84              		.cfi_offset 4, -12
  85              		.cfi_offset 5, -8
ARM GAS  /tmp/ccNhsg46.s 			page 4


  86              		.cfi_offset 14, -4
  87 0002 0446     		mov	r4, r0
  47:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  88              		.loc 1 47 0
  89 0004 8368     		ldr	r3, [r0, #8]
  90 0006 0121     		movs	r1, #1
  91 0008 0068     		ldr	r0, [r0]
  92              	.LVL6:
  93 000a 9847     		blx	r3
  94              	.LVL7:
  49:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         goto done;
  95              		.loc 1 49 0
  96 000c 2369     		ldr	r3, [r4, #16]
  97 000e 8BB1     		cbz	r3, .L4
  52:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     while (!GET_SCL(ops))
  98              		.loc 1 52 0
  99 0010 FFF7FEFF 		bl	rt_tick_get
 100              	.LVL8:
 101 0014 0546     		mov	r5, r0
 102              	.LVL9:
 103              	.L5:
  53:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 104              		.loc 1 53 0
 105 0016 2369     		ldr	r3, [r4, #16]
 106 0018 2068     		ldr	r0, [r4]
 107 001a 9847     		blx	r3
 108              	.LVL10:
 109 001c 50B9     		cbnz	r0, .L4
  55:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_ETIMEOUT;
 110              		.loc 1 55 0
 111 001e FFF7FEFF 		bl	rt_tick_get
 112              	.LVL11:
 113 0022 401B     		subs	r0, r0, r5
 114 0024 E369     		ldr	r3, [r4, #28]
 115 0026 9842     		cmp	r0, r3
 116 0028 0BD8     		bhi	.L8
  57:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 117              		.loc 1 57 0
 118 002a 581C     		adds	r0, r3, #1
 119 002c 4008     		lsrs	r0, r0, #1
 120 002e FFF7FEFF 		bl	rt_thread_delay
 121              	.LVL12:
 122 0032 F0E7     		b	.L5
 123              	.LVL13:
 124              	.L4:
 125              	.LBB32:
 126              	.LBB33:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 127              		.loc 1 28 0
 128 0034 6369     		ldr	r3, [r4, #20]
 129 0036 A069     		ldr	r0, [r4, #24]
 130 0038 0130     		adds	r0, r0, #1
 131 003a 4008     		lsrs	r0, r0, #1
 132 003c 9847     		blx	r3
 133              	.LVL14:
 134              	.LBE33:
 135              	.LBE32:
ARM GAS  /tmp/ccNhsg46.s 			page 5


  70:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 136              		.loc 1 70 0
 137 003e 0020     		movs	r0, #0
 138 0040 38BD     		pop	{r3, r4, r5, pc}
 139              	.LVL15:
 140              	.L8:
  56:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         rt_thread_delay((ops->timeout + 1) >> 1);
 141              		.loc 1 56 0
 142 0042 6FF00100 		mvn	r0, #1
  71:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 143              		.loc 1 71 0
 144 0046 38BD     		pop	{r3, r4, r5, pc}
 145              		.cfi_endproc
 146              	.LFE21:
 148              		.section	.text.i2c_restart,"ax",%progbits
 149              		.align	1
 150              		.syntax unified
 151              		.thumb
 152              		.thumb_func
 153              		.fpu fpv4-sp-d16
 155              	i2c_restart:
 156              	.LFB23:
  88:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  89:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
  90:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static void i2c_restart(struct rt_i2c_bit_ops *ops)
  91:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 157              		.loc 1 91 0
 158              		.cfi_startproc
 159              		@ args = 0, pretend = 0, frame = 0
 160              		@ frame_needed = 0, uses_anonymous_args = 0
 161              	.LVL16:
 162 0000 10B5     		push	{r4, lr}
 163              	.LCFI2:
 164              		.cfi_def_cfa_offset 8
 165              		.cfi_offset 4, -8
 166              		.cfi_offset 14, -4
 167 0002 0446     		mov	r4, r0
  92:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_H(ops);
 168              		.loc 1 92 0
 169 0004 4368     		ldr	r3, [r0, #4]
 170 0006 0121     		movs	r1, #1
 171 0008 0068     		ldr	r0, [r0]
 172              	.LVL17:
 173 000a 9847     		blx	r3
 174              	.LVL18:
  93:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_H(ops);
 175              		.loc 1 93 0
 176 000c 2046     		mov	r0, r4
 177 000e FFF7FEFF 		bl	SCL_H
 178              	.LVL19:
 179              	.LBB34:
 180              	.LBB35:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 181              		.loc 1 28 0
 182 0012 6369     		ldr	r3, [r4, #20]
 183 0014 A069     		ldr	r0, [r4, #24]
 184 0016 0130     		adds	r0, r0, #1
ARM GAS  /tmp/ccNhsg46.s 			page 6


 185 0018 4008     		lsrs	r0, r0, #1
 186 001a 9847     		blx	r3
 187              	.LVL20:
 188              	.LBE35:
 189              	.LBE34:
  94:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
  95:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_L(ops);
 190              		.loc 1 95 0
 191 001c 6368     		ldr	r3, [r4, #4]
 192 001e 0021     		movs	r1, #0
 193 0020 2068     		ldr	r0, [r4]
 194 0022 9847     		blx	r3
 195              	.LVL21:
 196              	.LBB36:
 197              	.LBB37:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 198              		.loc 1 28 0
 199 0024 6369     		ldr	r3, [r4, #20]
 200 0026 A069     		ldr	r0, [r4, #24]
 201 0028 0130     		adds	r0, r0, #1
 202 002a 4008     		lsrs	r0, r0, #1
 203 002c 9847     		blx	r3
 204              	.LVL22:
 205              	.LBE37:
 206              	.LBE36:
  96:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
  97:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_L(ops);
 207              		.loc 1 97 0
 208 002e A368     		ldr	r3, [r4, #8]
 209 0030 0021     		movs	r1, #0
 210 0032 2068     		ldr	r0, [r4]
 211 0034 9847     		blx	r3
 212              	.LVL23:
 213 0036 10BD     		pop	{r4, pc}
 214              		.cfi_endproc
 215              	.LFE23:
 217              		.section	.text.i2c_writeb,"ax",%progbits
 218              		.align	1
 219              		.syntax unified
 220              		.thumb
 221              		.thumb_func
 222              		.fpu fpv4-sp-d16
 224              	i2c_writeb:
 225              	.LFB26:
  98:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
  99:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 100:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static void i2c_stop(struct rt_i2c_bit_ops *ops)
 101:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 102:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_L(ops);
 103:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 104:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_H(ops);
 105:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 106:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_H(ops);
 107:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay2(ops);
 108:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 109:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 110:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** rt_inline rt_bool_t i2c_waitack(struct rt_i2c_bit_ops *ops)
ARM GAS  /tmp/ccNhsg46.s 			page 7


 111:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 112:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_bool_t ack;
 113:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 114:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_H(ops);
 115:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 116:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 117:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (SCL_H(ops) < 0)
 118:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 119:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_W("wait ack timeout");
 120:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 121:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         return -RT_ETIMEOUT;
 122:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 123:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 124:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     ack = !GET_SDA(ops);    /* ACK : SDA pin is pulled low */
 125:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     LOG_D("%s", ack ? "ACK" : "NACK");
 126:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 127:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_L(ops);
 128:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 129:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return ack;
 130:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 131:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 132:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_int32_t i2c_writeb(struct rt_i2c_bus_device *bus, rt_uint8_t data)
 133:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 226              		.loc 1 133 0
 227              		.cfi_startproc
 228              		@ args = 0, pretend = 0, frame = 0
 229              		@ frame_needed = 0, uses_anonymous_args = 0
 230              	.LVL24:
 231 0000 70B5     		push	{r4, r5, r6, lr}
 232              	.LCFI3:
 233              		.cfi_def_cfa_offset 16
 234              		.cfi_offset 4, -16
 235              		.cfi_offset 5, -12
 236              		.cfi_offset 6, -8
 237              		.cfi_offset 14, -4
 238 0002 0E46     		mov	r6, r1
 134:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t i;
 135:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t bit;
 136:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 137:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 239              		.loc 1 137 0
 240 0004 046E     		ldr	r4, [r0, #96]
 241              	.LVL25:
 138:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 139:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     for (i = 7; i >= 0; i--)
 242              		.loc 1 139 0
 243 0006 0725     		movs	r5, #7
 244              	.LVL26:
 245              	.L13:
 246              		.loc 1 139 0 is_stmt 0 discriminator 1
 247 0008 002D     		cmp	r5, #0
 248 000a 16DB     		blt	.L20
 140:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 141:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         SCL_L(ops);
 249              		.loc 1 141 0 is_stmt 1
 250 000c A368     		ldr	r3, [r4, #8]
 251 000e 0021     		movs	r1, #0
ARM GAS  /tmp/ccNhsg46.s 			page 8


 252 0010 2068     		ldr	r0, [r4]
 253 0012 9847     		blx	r3
 254              	.LVL27:
 142:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         bit = (data >> i) & 1;
 255              		.loc 1 142 0
 256 0014 46FA05F1 		asr	r1, r6, r5
 143:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         SET_SDA(ops, bit);
 257              		.loc 1 143 0
 258 0018 6368     		ldr	r3, [r4, #4]
 259 001a 01F00101 		and	r1, r1, #1
 260 001e 2068     		ldr	r0, [r4]
 261 0020 9847     		blx	r3
 262              	.LVL28:
 263              	.LBB46:
 264              	.LBB47:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 265              		.loc 1 28 0
 266 0022 6369     		ldr	r3, [r4, #20]
 267 0024 A069     		ldr	r0, [r4, #24]
 268 0026 0130     		adds	r0, r0, #1
 269 0028 4008     		lsrs	r0, r0, #1
 270 002a 9847     		blx	r3
 271              	.LVL29:
 272              	.LBE47:
 273              	.LBE46:
 144:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_delay(ops);
 145:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (SCL_H(ops) < 0)
 274              		.loc 1 145 0
 275 002c 2046     		mov	r0, r4
 276 002e FFF7FEFF 		bl	SCL_H
 277              	.LVL30:
 278 0032 0028     		cmp	r0, #0
 279 0034 27DB     		blt	.L17
 139:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 280              		.loc 1 139 0 discriminator 2
 281 0036 013D     		subs	r5, r5, #1
 282              	.LVL31:
 283 0038 E6E7     		b	.L13
 284              	.L20:
 146:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 147:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_D("i2c_writeb: 0x%02x, "
 148:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     "wait scl pin high timeout at bit %d",
 149:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     data, i);
 150:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 151:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_ETIMEOUT;
 152:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 153:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 154:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_L(ops);
 285              		.loc 1 154 0
 286 003a A368     		ldr	r3, [r4, #8]
 287 003c 0021     		movs	r1, #0
 288 003e 2068     		ldr	r0, [r4]
 289 0040 9847     		blx	r3
 290              	.LVL32:
 291              	.LBB48:
 292              	.LBB49:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
ARM GAS  /tmp/ccNhsg46.s 			page 9


 293              		.loc 1 28 0
 294 0042 6369     		ldr	r3, [r4, #20]
 295 0044 A069     		ldr	r0, [r4, #24]
 296 0046 0130     		adds	r0, r0, #1
 297 0048 4008     		lsrs	r0, r0, #1
 298 004a 9847     		blx	r3
 299              	.LVL33:
 300              	.LBE49:
 301              	.LBE48:
 302              	.LBB50:
 303              	.LBB51:
 114:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 304              		.loc 1 114 0
 305 004c 6368     		ldr	r3, [r4, #4]
 306 004e 0121     		movs	r1, #1
 307 0050 2068     		ldr	r0, [r4]
 308 0052 9847     		blx	r3
 309              	.LVL34:
 310              	.LBB52:
 311              	.LBB53:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 312              		.loc 1 28 0
 313 0054 6369     		ldr	r3, [r4, #20]
 314 0056 A069     		ldr	r0, [r4, #24]
 315 0058 0130     		adds	r0, r0, #1
 316 005a 4008     		lsrs	r0, r0, #1
 317 005c 9847     		blx	r3
 318              	.LVL35:
 319              	.LBE53:
 320              	.LBE52:
 117:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 321              		.loc 1 117 0
 322 005e 2046     		mov	r0, r4
 323 0060 FFF7FEFF 		bl	SCL_H
 324              	.LVL36:
 325 0064 0028     		cmp	r0, #0
 326 0066 0BDB     		blt	.L18
 124:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     LOG_D("%s", ack ? "ACK" : "NACK");
 327              		.loc 1 124 0
 328 0068 E368     		ldr	r3, [r4, #12]
 329 006a 2068     		ldr	r0, [r4]
 330 006c 9847     		blx	r3
 331              	.LVL37:
 332 006e B0FA80F5 		clz	r5, r0
 333              	.LVL38:
 334 0072 6D09     		lsrs	r5, r5, #5
 335              	.LVL39:
 127:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 336              		.loc 1 127 0
 337 0074 A368     		ldr	r3, [r4, #8]
 338 0076 0021     		movs	r1, #0
 339 0078 2068     		ldr	r0, [r4]
 340 007a 9847     		blx	r3
 341              	.LVL40:
 342              	.L12:
 343              	.LBE51:
 344              	.LBE50:
ARM GAS  /tmp/ccNhsg46.s 			page 10


 155:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 156:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 157:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return i2c_waitack(ops);
 158:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 345              		.loc 1 158 0
 346 007c 2846     		mov	r0, r5
 347 007e 70BD     		pop	{r4, r5, r6, pc}
 348              	.LVL41:
 349              	.L18:
 350              	.LBB55:
 351              	.LBB54:
 121:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 352              		.loc 1 121 0
 353 0080 6FF00105 		mvn	r5, #1
 354              	.LVL42:
 355              	.LBE54:
 356              	.LBE55:
 157:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 357              		.loc 1 157 0
 358 0084 FAE7     		b	.L12
 359              	.LVL43:
 360              	.L17:
 151:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 361              		.loc 1 151 0
 362 0086 6FF00105 		mvn	r5, #1
 363              	.LVL44:
 364 008a F7E7     		b	.L12
 365              		.cfi_endproc
 366              	.LFE26:
 368              		.section	.text.i2c_send_bytes,"ax",%progbits
 369              		.align	1
 370              		.syntax unified
 371              		.thumb
 372              		.thumb_func
 373              		.fpu fpv4-sp-d16
 375              	i2c_send_bytes:
 376              	.LFB28:
 159:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 160:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_int32_t i2c_readb(struct rt_i2c_bus_device *bus)
 161:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 162:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t i;
 163:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t data = 0;
 164:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 165:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 166:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_H(ops);
 167:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 168:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     for (i = 0; i < 8; i++)
 169:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 170:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         data <<= 1;
 171:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 172:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (SCL_H(ops) < 0)
 173:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 174:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_D("i2c_readb: wait scl pin high "
 175:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     "timeout at bit %d", 7 - i);
 176:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 177:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_ETIMEOUT;
 178:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
ARM GAS  /tmp/ccNhsg46.s 			page 11


 179:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 180:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (GET_SDA(ops))
 181:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             data |= 1;
 182:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         SCL_L(ops);
 183:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_delay2(ops);
 184:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 185:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 186:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return data;
 187:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 188:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 189:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_size_t i2c_send_bytes(struct rt_i2c_bus_device *bus,
 190:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                                 struct rt_i2c_msg        *msg)
 191:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 377              		.loc 1 191 0
 378              		.cfi_startproc
 379              		@ args = 0, pretend = 0, frame = 0
 380              		@ frame_needed = 0, uses_anonymous_args = 0
 381              	.LVL45:
 382 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 383              	.LCFI4:
 384              		.cfi_def_cfa_offset 24
 385              		.cfi_offset 4, -24
 386              		.cfi_offset 5, -20
 387              		.cfi_offset 6, -16
 388              		.cfi_offset 7, -12
 389              		.cfi_offset 8, -8
 390              		.cfi_offset 14, -4
 391 0004 0746     		mov	r7, r0
 392              	.LVL46:
 192:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t ret;
 193:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_size_t bytes = 0;
 194:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     const rt_uint8_t *ptr = msg->buf;
 393              		.loc 1 194 0
 394 0006 8D68     		ldr	r5, [r1, #8]
 395              	.LVL47:
 195:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t count = msg->len;
 396              		.loc 1 195 0
 397 0008 8C88     		ldrh	r4, [r1, #4]
 398              	.LVL48:
 196:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint16_t ignore_nack = msg->flags & RT_I2C_IGNORE_NACK;
 399              		.loc 1 196 0
 400 000a B1F80280 		ldrh	r8, [r1, #2]
 401 000e 08F02008 		and	r8, r8, #32
 402              	.LVL49:
 193:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     const rt_uint8_t *ptr = msg->buf;
 403              		.loc 1 193 0
 404 0012 0026     		movs	r6, #0
 197:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 198:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     while (count > 0)
 405              		.loc 1 198 0
 406 0014 02E0     		b	.L22
 407              	.LVL50:
 408              	.L23:
 199:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 200:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ret = i2c_writeb(bus, *ptr);
 201:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 202:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret > 0) || (ignore_nack && (ret == 0)))
ARM GAS  /tmp/ccNhsg46.s 			page 12


 203:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 204:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             count --;
 409              		.loc 1 204 0
 410 0016 013C     		subs	r4, r4, #1
 411              	.LVL51:
 205:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             ptr ++;
 412              		.loc 1 205 0
 413 0018 0135     		adds	r5, r5, #1
 414              	.LVL52:
 206:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             bytes ++;
 415              		.loc 1 206 0
 416 001a 0136     		adds	r6, r6, #1
 417              	.LVL53:
 418              	.L22:
 198:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 419              		.loc 1 198 0
 420 001c 002C     		cmp	r4, #0
 421 001e 0EDD     		ble	.L21
 200:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 422              		.loc 1 200 0
 423 0020 2978     		ldrb	r1, [r5]	@ zero_extendqisi2
 424 0022 3846     		mov	r0, r7
 425 0024 FFF7FEFF 		bl	i2c_writeb
 426              	.LVL54:
 202:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 427              		.loc 1 202 0
 428 0028 0028     		cmp	r0, #0
 429 002a F4DC     		bgt	.L23
 202:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 430              		.loc 1 202 0 is_stmt 0 discriminator 1
 431 002c B8F1000F 		cmp	r8, #0
 432 0030 01D0     		beq	.L24
 202:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 433              		.loc 1 202 0 discriminator 2
 434 0032 0028     		cmp	r0, #0
 435 0034 EFD0     		beq	.L23
 436              	.L24:
 207:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 208:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         else if (ret == 0)
 437              		.loc 1 208 0 is_stmt 1
 438 0036 08B1     		cbz	r0, .L27
 209:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 210:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_D("send bytes: NACK.");
 211:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 212:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return 0;
 213:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 214:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         else
 215:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 216:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_E("send bytes: error %d", ret);
 217:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 218:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return ret;
 439              		.loc 1 218 0
 440 0038 0646     		mov	r6, r0
 441              	.LVL55:
 442 003a 00E0     		b	.L21
 443              	.LVL56:
 444              	.L27:
ARM GAS  /tmp/ccNhsg46.s 			page 13


 212:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 445              		.loc 1 212 0
 446 003c 0026     		movs	r6, #0
 447              	.LVL57:
 448              	.L21:
 219:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 220:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 221:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 222:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return bytes;
 223:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 449              		.loc 1 223 0
 450 003e 3046     		mov	r0, r6
 451 0040 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 452              		.cfi_endproc
 453              	.LFE28:
 455              		.section	.text.i2c_readb,"ax",%progbits
 456              		.align	1
 457              		.syntax unified
 458              		.thumb
 459              		.thumb_func
 460              		.fpu fpv4-sp-d16
 462              	i2c_readb:
 463              	.LFB27:
 161:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t i;
 464              		.loc 1 161 0
 465              		.cfi_startproc
 466              		@ args = 0, pretend = 0, frame = 0
 467              		@ frame_needed = 0, uses_anonymous_args = 0
 468              	.LVL58:
 469 0000 70B5     		push	{r4, r5, r6, lr}
 470              	.LCFI5:
 471              		.cfi_def_cfa_offset 16
 472              		.cfi_offset 4, -16
 473              		.cfi_offset 5, -12
 474              		.cfi_offset 6, -8
 475              		.cfi_offset 14, -4
 476              	.LVL59:
 164:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 477              		.loc 1 164 0
 478 0002 046E     		ldr	r4, [r0, #96]
 479              	.LVL60:
 166:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 480              		.loc 1 166 0
 481 0004 6368     		ldr	r3, [r4, #4]
 482 0006 0121     		movs	r1, #1
 483 0008 2068     		ldr	r0, [r4]
 484              	.LVL61:
 485 000a 9847     		blx	r3
 486              	.LVL62:
 487              	.LBB56:
 488              	.LBB57:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 489              		.loc 1 28 0
 490 000c 6369     		ldr	r3, [r4, #20]
 491 000e A069     		ldr	r0, [r4, #24]
 492 0010 0130     		adds	r0, r0, #1
 493 0012 4008     		lsrs	r0, r0, #1
ARM GAS  /tmp/ccNhsg46.s 			page 14


 494 0014 9847     		blx	r3
 495              	.LVL63:
 496              	.LBE57:
 497              	.LBE56:
 163:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 498              		.loc 1 163 0
 499 0016 0025     		movs	r5, #0
 168:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 500              		.loc 1 168 0
 501 0018 2E46     		mov	r6, r5
 502 001a 08E0     		b	.L30
 503              	.LVL64:
 504              	.L32:
 182:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_delay2(ops);
 505              		.loc 1 182 0 discriminator 2
 506 001c A368     		ldr	r3, [r4, #8]
 507 001e 0021     		movs	r1, #0
 508 0020 2068     		ldr	r0, [r4]
 509 0022 9847     		blx	r3
 510              	.LVL65:
 511              	.LBB58:
 512              	.LBB59:
  33:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 513              		.loc 1 33 0 discriminator 2
 514 0024 6369     		ldr	r3, [r4, #20]
 515 0026 A069     		ldr	r0, [r4, #24]
 516 0028 9847     		blx	r3
 517              	.LVL66:
 518              	.LBE59:
 519              	.LBE58:
 168:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 520              		.loc 1 168 0 discriminator 2
 521 002a 0136     		adds	r6, r6, #1
 522              	.LVL67:
 523 002c F6B2     		uxtb	r6, r6
 524              	.LVL68:
 525              	.L30:
 168:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 526              		.loc 1 168 0 is_stmt 0 discriminator 1
 527 002e 072E     		cmp	r6, #7
 528 0030 0ED8     		bhi	.L36
 170:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 529              		.loc 1 170 0 is_stmt 1
 530 0032 6D00     		lsls	r5, r5, #1
 531              	.LVL69:
 532 0034 EDB2     		uxtb	r5, r5
 533              	.LVL70:
 172:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 534              		.loc 1 172 0
 535 0036 2046     		mov	r0, r4
 536 0038 FFF7FEFF 		bl	SCL_H
 537              	.LVL71:
 538 003c 0028     		cmp	r0, #0
 539 003e 09DB     		blt	.L34
 180:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             data |= 1;
 540              		.loc 1 180 0
 541 0040 E368     		ldr	r3, [r4, #12]
ARM GAS  /tmp/ccNhsg46.s 			page 15


 542 0042 2068     		ldr	r0, [r4]
 543 0044 9847     		blx	r3
 544              	.LVL72:
 545 0046 0028     		cmp	r0, #0
 546 0048 E8D0     		beq	.L32
 181:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         SCL_L(ops);
 547              		.loc 1 181 0
 548 004a 45F00105 		orr	r5, r5, #1
 549              	.LVL73:
 550 004e E5E7     		b	.L32
 551              	.L36:
 186:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 552              		.loc 1 186 0
 553 0050 2846     		mov	r0, r5
 554 0052 70BD     		pop	{r4, r5, r6, pc}
 555              	.LVL74:
 556              	.L34:
 177:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 557              		.loc 1 177 0
 558 0054 6FF00100 		mvn	r0, #1
 187:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 559              		.loc 1 187 0
 560 0058 70BD     		pop	{r4, r5, r6, pc}
 561              		.cfi_endproc
 562              	.LFE27:
 564              		.section	.text.i2c_send_ack_or_nack,"ax",%progbits
 565              		.align	1
 566              		.syntax unified
 567              		.thumb
 568              		.thumb_func
 569              		.fpu fpv4-sp-d16
 571              	i2c_send_ack_or_nack:
 572              	.LFB29:
 224:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 225:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_err_t i2c_send_ack_or_nack(struct rt_i2c_bus_device *bus, int ack)
 226:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 573              		.loc 1 226 0
 574              		.cfi_startproc
 575              		@ args = 0, pretend = 0, frame = 0
 576              		@ frame_needed = 0, uses_anonymous_args = 0
 577              	.LVL75:
 578 0000 10B5     		push	{r4, lr}
 579              	.LCFI6:
 580              		.cfi_def_cfa_offset 8
 581              		.cfi_offset 4, -8
 582              		.cfi_offset 14, -4
 227:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 583              		.loc 1 227 0
 584 0002 046E     		ldr	r4, [r0, #96]
 585              	.LVL76:
 228:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 229:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (ack)
 586              		.loc 1 229 0
 587 0004 79B9     		cbnz	r1, .L42
 588              	.LVL77:
 589              	.L38:
 590              	.LBB60:
ARM GAS  /tmp/ccNhsg46.s 			page 16


 591              	.LBB61:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 592              		.loc 1 28 0
 593 0006 6369     		ldr	r3, [r4, #20]
 594 0008 A069     		ldr	r0, [r4, #24]
 595 000a 0130     		adds	r0, r0, #1
 596 000c 4008     		lsrs	r0, r0, #1
 597 000e 9847     		blx	r3
 598              	.LVL78:
 599              	.LBE61:
 600              	.LBE60:
 230:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         SET_SDA(ops, 0);
 231:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 232:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (SCL_H(ops) < 0)
 601              		.loc 1 232 0
 602 0010 2046     		mov	r0, r4
 603 0012 FFF7FEFF 		bl	SCL_H
 604              	.LVL79:
 605 0016 0028     		cmp	r0, #0
 606 0018 0ADB     		blt	.L40
 233:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 234:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_E("ACK or NACK timeout.");
 235:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 236:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         return -RT_ETIMEOUT;
 237:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 238:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SCL_L(ops);
 607              		.loc 1 238 0
 608 001a A368     		ldr	r3, [r4, #8]
 609 001c 0021     		movs	r1, #0
 610 001e 2068     		ldr	r0, [r4]
 611 0020 9847     		blx	r3
 612              	.LVL80:
 239:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 240:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return RT_EOK;
 613              		.loc 1 240 0
 614 0022 0020     		movs	r0, #0
 615 0024 10BD     		pop	{r4, pc}
 616              	.LVL81:
 617              	.L42:
 230:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 618              		.loc 1 230 0
 619 0026 6368     		ldr	r3, [r4, #4]
 620 0028 0021     		movs	r1, #0
 621              	.LVL82:
 622 002a 2068     		ldr	r0, [r4]
 623              	.LVL83:
 624 002c 9847     		blx	r3
 625              	.LVL84:
 626 002e EAE7     		b	.L38
 627              	.L40:
 236:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 628              		.loc 1 236 0
 629 0030 6FF00100 		mvn	r0, #1
 241:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 630              		.loc 1 241 0
 631 0034 10BD     		pop	{r4, pc}
 632              		.cfi_endproc
ARM GAS  /tmp/ccNhsg46.s 			page 17


 633              	.LFE29:
 635              		.section	.text.i2c_recv_bytes,"ax",%progbits
 636              		.align	1
 637              		.syntax unified
 638              		.thumb
 639              		.thumb_func
 640              		.fpu fpv4-sp-d16
 642              	i2c_recv_bytes:
 643              	.LFB30:
 242:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 243:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_size_t i2c_recv_bytes(struct rt_i2c_bus_device *bus,
 244:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                                 struct rt_i2c_msg        *msg)
 245:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 644              		.loc 1 245 0
 645              		.cfi_startproc
 646              		@ args = 0, pretend = 0, frame = 0
 647              		@ frame_needed = 0, uses_anonymous_args = 0
 648              	.LVL85:
 649 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 650              	.LCFI7:
 651              		.cfi_def_cfa_offset 24
 652              		.cfi_offset 4, -24
 653              		.cfi_offset 5, -20
 654              		.cfi_offset 6, -16
 655              		.cfi_offset 7, -12
 656              		.cfi_offset 8, -8
 657              		.cfi_offset 14, -4
 658 0004 0746     		mov	r7, r0
 659              	.LVL86:
 246:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t val;
 247:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t bytes = 0;   /* actual bytes */
 248:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t *ptr = msg->buf;
 660              		.loc 1 248 0
 661 0006 8E68     		ldr	r6, [r1, #8]
 662              	.LVL87:
 249:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t count = msg->len;
 663              		.loc 1 249 0
 664 0008 8C88     		ldrh	r4, [r1, #4]
 665              	.LVL88:
 250:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     const rt_uint32_t flags = msg->flags;
 666              		.loc 1 250 0
 667 000a B1F80280 		ldrh	r8, [r1, #2]
 668              	.LVL89:
 247:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t *ptr = msg->buf;
 669              		.loc 1 247 0
 670 000e 0025     		movs	r5, #0
 671              	.LVL90:
 672              	.L44:
 251:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 252:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     while (count > 0)
 673              		.loc 1 252 0
 674 0010 002C     		cmp	r4, #0
 675 0012 12DD     		ble	.L45
 253:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 254:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         val = i2c_readb(bus);
 676              		.loc 1 254 0
 677 0014 3846     		mov	r0, r7
ARM GAS  /tmp/ccNhsg46.s 			page 18


 678 0016 FFF7FEFF 		bl	i2c_readb
 679              	.LVL91:
 255:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (val >= 0)
 680              		.loc 1 255 0
 681 001a 0028     		cmp	r0, #0
 682 001c 0DDB     		blt	.L45
 256:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 257:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             *ptr = val;
 683              		.loc 1 257 0
 684 001e 06F8010B 		strb	r0, [r6], #1
 685              	.LVL92:
 258:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             bytes ++;
 686              		.loc 1 258 0
 687 0022 0135     		adds	r5, r5, #1
 688              	.LVL93:
 259:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 260:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         else
 261:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 262:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             break;
 263:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 264:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 265:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ptr ++;
 266:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         count --;
 689              		.loc 1 266 0
 690 0024 013C     		subs	r4, r4, #1
 691              	.LVL94:
 267:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 268:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_D("recieve bytes: 0x%02x, %s",
 269:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 val, (flags & RT_I2C_NO_READ_ACK) ?
 270:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 "(No ACK/NACK)" : (count ? "ACK" : "NACK"));
 271:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 272:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (!(flags & RT_I2C_NO_READ_ACK))
 692              		.loc 1 272 0
 693 0026 18F0400F 		tst	r8, #64
 694 002a F1D1     		bne	.L44
 273:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 274:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             val = i2c_send_ack_or_nack(bus, count);
 695              		.loc 1 274 0
 696 002c 2146     		mov	r1, r4
 697 002e 3846     		mov	r0, r7
 698              	.LVL95:
 699 0030 FFF7FEFF 		bl	i2c_send_ack_or_nack
 700              	.LVL96:
 275:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (val < 0)
 701              		.loc 1 275 0
 702 0034 0028     		cmp	r0, #0
 703 0036 EBDA     		bge	.L44
 704 0038 00E0     		b	.L43
 705              	.LVL97:
 706              	.L45:
 276:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 return val;
 277:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 278:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 279:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 280:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return bytes;
 707              		.loc 1 280 0
 708 003a 2846     		mov	r0, r5
ARM GAS  /tmp/ccNhsg46.s 			page 19


 709              	.L43:
 281:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 710              		.loc 1 281 0
 711 003c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 712              		.cfi_endproc
 713              	.LFE30:
 715              		.section	.text.i2c_stop,"ax",%progbits
 716              		.align	1
 717              		.syntax unified
 718              		.thumb
 719              		.thumb_func
 720              		.fpu fpv4-sp-d16
 722              	i2c_stop:
 723              	.LFB24:
 101:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     SDA_L(ops);
 724              		.loc 1 101 0
 725              		.cfi_startproc
 726              		@ args = 0, pretend = 0, frame = 0
 727              		@ frame_needed = 0, uses_anonymous_args = 0
 728              	.LVL98:
 729 0000 10B5     		push	{r4, lr}
 730              	.LCFI8:
 731              		.cfi_def_cfa_offset 8
 732              		.cfi_offset 4, -8
 733              		.cfi_offset 14, -4
 734 0002 0446     		mov	r4, r0
 102:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 735              		.loc 1 102 0
 736 0004 4368     		ldr	r3, [r0, #4]
 737 0006 0021     		movs	r1, #0
 738 0008 0068     		ldr	r0, [r0]
 739              	.LVL99:
 740 000a 9847     		blx	r3
 741              	.LVL100:
 742              	.LBB62:
 743              	.LBB63:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 744              		.loc 1 28 0
 745 000c 6369     		ldr	r3, [r4, #20]
 746 000e A069     		ldr	r0, [r4, #24]
 747 0010 0130     		adds	r0, r0, #1
 748 0012 4008     		lsrs	r0, r0, #1
 749 0014 9847     		blx	r3
 750              	.LVL101:
 751              	.LBE63:
 752              	.LBE62:
 104:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay(ops);
 753              		.loc 1 104 0
 754 0016 2046     		mov	r0, r4
 755 0018 FFF7FEFF 		bl	SCL_H
 756              	.LVL102:
 757              	.LBB64:
 758              	.LBB65:
  28:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 759              		.loc 1 28 0
 760 001c 6369     		ldr	r3, [r4, #20]
 761 001e A069     		ldr	r0, [r4, #24]
ARM GAS  /tmp/ccNhsg46.s 			page 20


 762 0020 0130     		adds	r0, r0, #1
 763 0022 4008     		lsrs	r0, r0, #1
 764 0024 9847     		blx	r3
 765              	.LVL103:
 766              	.LBE65:
 767              	.LBE64:
 106:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_delay2(ops);
 768              		.loc 1 106 0
 769 0026 6368     		ldr	r3, [r4, #4]
 770 0028 0121     		movs	r1, #1
 771 002a 2068     		ldr	r0, [r4]
 772 002c 9847     		blx	r3
 773              	.LVL104:
 774              	.LBB66:
 775              	.LBB67:
  33:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 776              		.loc 1 33 0
 777 002e 6369     		ldr	r3, [r4, #20]
 778 0030 A069     		ldr	r0, [r4, #24]
 779 0032 9847     		blx	r3
 780              	.LVL105:
 781 0034 10BD     		pop	{r4, pc}
 782              	.LBE67:
 783              	.LBE66:
 784              		.cfi_endproc
 785              	.LFE24:
 787              		.section	.text.i2c_send_address,"ax",%progbits
 788              		.align	1
 789              		.syntax unified
 790              		.thumb
 791              		.thumb_func
 792              		.fpu fpv4-sp-d16
 794              	i2c_send_address:
 795              	.LFB31:
 282:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 283:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_int32_t i2c_send_address(struct rt_i2c_bus_device *bus,
 284:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                                    rt_uint8_t                addr,
 285:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                                    rt_int32_t                retries)
 286:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 796              		.loc 1 286 0
 797              		.cfi_startproc
 798              		@ args = 0, pretend = 0, frame = 0
 799              		@ frame_needed = 0, uses_anonymous_args = 0
 800              	.LVL106:
 801 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 802              	.LCFI9:
 803              		.cfi_def_cfa_offset 32
 804              		.cfi_offset 3, -32
 805              		.cfi_offset 4, -28
 806              		.cfi_offset 5, -24
 807              		.cfi_offset 6, -20
 808              		.cfi_offset 7, -16
 809              		.cfi_offset 8, -12
 810              		.cfi_offset 9, -8
 811              		.cfi_offset 14, -4
 812 0004 8046     		mov	r8, r0
 813 0006 8946     		mov	r9, r1
ARM GAS  /tmp/ccNhsg46.s 			page 21


 814 0008 1746     		mov	r7, r2
 287:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 815              		.loc 1 287 0
 816 000a 056E     		ldr	r5, [r0, #96]
 817              	.LVL107:
 288:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t i;
 289:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_err_t ret = 0;
 818              		.loc 1 289 0
 819 000c 0026     		movs	r6, #0
 290:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 291:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     for (i = 0; i <= retries; i++)
 820              		.loc 1 291 0
 821 000e 3446     		mov	r4, r6
 822              	.LVL108:
 823              	.L53:
 824              		.loc 1 291 0 is_stmt 0 discriminator 1
 825 0010 BC42     		cmp	r4, r7
 826 0012 13DC     		bgt	.L54
 292:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 293:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ret = i2c_writeb(bus, addr);
 827              		.loc 1 293 0 is_stmt 1
 828 0014 4946     		mov	r1, r9
 829 0016 4046     		mov	r0, r8
 830 0018 FFF7FEFF 		bl	i2c_writeb
 831              	.LVL109:
 832 001c 0646     		mov	r6, r0
 833              	.LVL110:
 294:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (ret == 1 || i == retries)
 834              		.loc 1 294 0
 835 001e 0128     		cmp	r0, #1
 836 0020 0CD0     		beq	.L54
 837              		.loc 1 294 0 is_stmt 0 discriminator 1
 838 0022 BC42     		cmp	r4, r7
 839 0024 0AD0     		beq	.L54
 295:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             break;
 296:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_D("send stop condition");
 297:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_stop(ops);
 840              		.loc 1 297 0 is_stmt 1 discriminator 2
 841 0026 2846     		mov	r0, r5
 842              	.LVL111:
 843 0028 FFF7FEFF 		bl	i2c_stop
 844              	.LVL112:
 845              	.LBB68:
 846              	.LBB69:
  33:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 847              		.loc 1 33 0 discriminator 2
 848 002c 6B69     		ldr	r3, [r5, #20]
 849 002e A869     		ldr	r0, [r5, #24]
 850 0030 9847     		blx	r3
 851              	.LVL113:
 852              	.LBE69:
 853              	.LBE68:
 298:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_delay2(ops);
 299:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_D("send start condition");
 300:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         i2c_start(ops);
 854              		.loc 1 300 0 discriminator 2
 855 0032 2846     		mov	r0, r5
ARM GAS  /tmp/ccNhsg46.s 			page 22


 856 0034 FFF7FEFF 		bl	i2c_start
 857              	.LVL114:
 291:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 858              		.loc 1 291 0 discriminator 2
 859 0038 0134     		adds	r4, r4, #1
 860              	.LVL115:
 861 003a E9E7     		b	.L53
 862              	.L54:
 301:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 302:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 303:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return ret;
 304:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 863              		.loc 1 304 0
 864 003c 3046     		mov	r0, r6
 865 003e BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 866              		.cfi_endproc
 867              	.LFE31:
 869              		.section	.text.i2c_bit_send_address,"ax",%progbits
 870              		.align	1
 871              		.syntax unified
 872              		.thumb
 873              		.thumb_func
 874              		.fpu fpv4-sp-d16
 876              	i2c_bit_send_address:
 877              	.LFB32:
 305:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 306:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_err_t i2c_bit_send_address(struct rt_i2c_bus_device *bus,
 307:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                                      struct rt_i2c_msg        *msg)
 308:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 878              		.loc 1 308 0
 879              		.cfi_startproc
 880              		@ args = 0, pretend = 0, frame = 0
 881              		@ frame_needed = 0, uses_anonymous_args = 0
 882              	.LVL116:
 883 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 884              	.LCFI10:
 885              		.cfi_def_cfa_offset 32
 886              		.cfi_offset 4, -32
 887              		.cfi_offset 5, -28
 888              		.cfi_offset 6, -24
 889              		.cfi_offset 7, -20
 890              		.cfi_offset 8, -16
 891              		.cfi_offset 9, -12
 892              		.cfi_offset 10, -8
 893              		.cfi_offset 14, -4
 894 0004 0546     		mov	r5, r0
 309:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint16_t flags = msg->flags;
 895              		.loc 1 309 0
 896 0006 4C88     		ldrh	r4, [r1, #2]
 897              	.LVL117:
 310:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint16_t ignore_nack = msg->flags & RT_I2C_IGNORE_NACK;
 311:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 898              		.loc 1 311 0
 899 0008 D0F86090 		ldr	r9, [r0, #96]
 900              	.LVL118:
 312:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 313:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint8_t addr1, addr2;
ARM GAS  /tmp/ccNhsg46.s 			page 23


 314:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t retries;
 315:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_err_t ret;
 316:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 317:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     retries = ignore_nack ? 0 : bus->retries;
 901              		.loc 1 317 0
 902 000c 14F02007 		ands	r7, r4, #32
 903 0010 15D1     		bne	.L64
 904              		.loc 1 317 0 is_stmt 0 discriminator 1
 905 0012 C66D     		ldr	r6, [r0, #92]
 906              	.L58:
 907              	.LVL119:
 318:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 319:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     if (flags & RT_I2C_ADDR_10BIT)
 908              		.loc 1 319 0 is_stmt 1 discriminator 4
 909 0014 14F0040F 		tst	r4, #4
 910 0018 13D1     		bne	.L73
 320:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 321:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         addr1 = 0xf0 | ((msg->addr >> 7) & 0x06);
 322:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         addr2 = msg->addr & 0xff;
 323:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 324:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         LOG_D("addr1: %d, addr2: %d", addr1, addr2);
 325:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 326:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ret = i2c_send_address(bus, addr1, retries);
 327:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret != 1) && !ignore_nack)
 328:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 329:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_W("NACK: sending first addr");
 330:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 331:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_EIO;
 332:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 333:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 334:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ret = i2c_writeb(bus, addr2);
 335:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret != 1) && !ignore_nack)
 336:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 337:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_W("NACK: sending second addr");
 338:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 339:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_EIO;
 340:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 341:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (flags & RT_I2C_RD)
 342:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 343:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             LOG_D("send repeated start condition");
 344:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             i2c_restart(ops);
 345:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             addr1 |= 0x01;
 346:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             ret = i2c_send_address(bus, addr1, retries);
 347:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if ((ret != 1) && !ignore_nack)
 348:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 349:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 LOG_E("NACK: sending repeated addr");
 350:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 351:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 return -RT_EIO;
 352:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 353:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 354:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 355:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     else
 356:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 357:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         /* 7-bit addr */
 358:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         addr1 = msg->addr << 1;
 911              		.loc 1 358 0
 912 001a 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
ARM GAS  /tmp/ccNhsg46.s 			page 24


 913              	.LVL120:
 914 001c 4900     		lsls	r1, r1, #1
 915 001e C9B2     		uxtb	r1, r1
 916              	.LVL121:
 359:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (flags & RT_I2C_RD)
 917              		.loc 1 359 0
 918 0020 14F0010F 		tst	r4, #1
 919 0024 01D0     		beq	.L63
 360:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             addr1 |= 1;
 920              		.loc 1 360 0
 921 0026 41F00101 		orr	r1, r1, #1
 922              	.LVL122:
 923              	.L63:
 361:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ret = i2c_send_address(bus, addr1, retries);
 924              		.loc 1 361 0
 925 002a 3246     		mov	r2, r6
 926 002c 2846     		mov	r0, r5
 927              	.LVL123:
 928 002e FFF7FEFF 		bl	i2c_send_address
 929              	.LVL124:
 362:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret != 1) && !ignore_nack)
 930              		.loc 1 362 0
 931 0032 0128     		cmp	r0, #1
 932 0034 45D0     		beq	.L70
 933              		.loc 1 362 0 is_stmt 0 discriminator 1
 934 0036 AFB3     		cbz	r7, .L74
 363:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             return -RT_EIO;
 364:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 365:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 366:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return RT_EOK;
 935              		.loc 1 366 0 is_stmt 1
 936 0038 0020     		movs	r0, #0
 937              	.LVL125:
 367:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 938              		.loc 1 367 0
 939 003a BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 940              	.LVL126:
 941              	.L64:
 317:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 942              		.loc 1 317 0
 943 003e 0026     		movs	r6, #0
 944 0040 E8E7     		b	.L58
 945              	.LVL127:
 946              	.L73:
 321:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         addr2 = msg->addr & 0xff;
 947              		.loc 1 321 0
 948 0042 0988     		ldrh	r1, [r1]
 949              	.LVL128:
 950 0044 4FEAD118 		lsr	r8, r1, #7
 951 0048 08F00608 		and	r8, r8, #6
 952 004c 48F0F008 		orr	r8, r8, #240
 953              	.LVL129:
 322:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 954              		.loc 1 322 0
 955 0050 5FFA81FA 		uxtb	r10, r1
 956              	.LVL130:
 326:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret != 1) && !ignore_nack)
ARM GAS  /tmp/ccNhsg46.s 			page 25


 957              		.loc 1 326 0
 958 0054 3246     		mov	r2, r6
 959 0056 4146     		mov	r1, r8
 960 0058 2846     		mov	r0, r5
 961              	.LVL131:
 962 005a FFF7FEFF 		bl	i2c_send_address
 963              	.LVL132:
 327:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 964              		.loc 1 327 0
 965 005e 0128     		cmp	r0, #1
 966 0060 00D0     		beq	.L60
 327:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 967              		.loc 1 327 0 is_stmt 0 discriminator 1
 968 0062 1FB3     		cbz	r7, .L65
 969              	.L60:
 334:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if ((ret != 1) && !ignore_nack)
 970              		.loc 1 334 0 is_stmt 1
 971 0064 5146     		mov	r1, r10
 972 0066 2846     		mov	r0, r5
 973              	.LVL133:
 974 0068 FFF7FEFF 		bl	i2c_writeb
 975              	.LVL134:
 335:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 976              		.loc 1 335 0
 977 006c 0128     		cmp	r0, #1
 978 006e 00D0     		beq	.L62
 335:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 979              		.loc 1 335 0 is_stmt 0 discriminator 1
 980 0070 07B3     		cbz	r7, .L66
 981              	.L62:
 341:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 982              		.loc 1 341 0 is_stmt 1
 983 0072 14F0010F 		tst	r4, #1
 984 0076 02D1     		bne	.L75
 366:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 985              		.loc 1 366 0
 986 0078 0020     		movs	r0, #0
 987              	.LVL135:
 988 007a BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 989              	.LVL136:
 990              	.L75:
 344:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             addr1 |= 0x01;
 991              		.loc 1 344 0
 992 007e 4846     		mov	r0, r9
 993              	.LVL137:
 994 0080 FFF7FEFF 		bl	i2c_restart
 995              	.LVL138:
 346:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if ((ret != 1) && !ignore_nack)
 996              		.loc 1 346 0
 997 0084 3246     		mov	r2, r6
 998 0086 48F00101 		orr	r1, r8, #1
 999 008a 2846     		mov	r0, r5
 1000 008c FFF7FEFF 		bl	i2c_send_address
 1001              	.LVL139:
 347:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1002              		.loc 1 347 0
 1003 0090 0128     		cmp	r0, #1
ARM GAS  /tmp/ccNhsg46.s 			page 26


 1004 0092 13D0     		beq	.L68
 347:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1005              		.loc 1 347 0 is_stmt 0 discriminator 1
 1006 0094 17B1     		cbz	r7, .L76
 366:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 1007              		.loc 1 366 0 is_stmt 1
 1008 0096 0020     		movs	r0, #0
 1009              	.LVL140:
 1010 0098 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1011              	.LVL141:
 1012              	.L76:
 351:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 1013              		.loc 1 351 0
 1014 009c 6FF00700 		mvn	r0, #7
 1015              	.LVL142:
 1016 00a0 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1017              	.LVL143:
 1018              	.L74:
 363:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 1019              		.loc 1 363 0
 1020 00a4 6FF00700 		mvn	r0, #7
 1021              	.LVL144:
 1022 00a8 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1023              	.LVL145:
 1024              	.L65:
 331:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 1025              		.loc 1 331 0
 1026 00ac 6FF00700 		mvn	r0, #7
 1027              	.LVL146:
 1028 00b0 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1029              	.LVL147:
 1030              	.L66:
 339:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 1031              		.loc 1 339 0
 1032 00b4 6FF00700 		mvn	r0, #7
 1033              	.LVL148:
 1034 00b8 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1035              	.LVL149:
 1036              	.L68:
 366:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 1037              		.loc 1 366 0
 1038 00bc 0020     		movs	r0, #0
 1039              	.LVL150:
 1040 00be BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1041              	.LVL151:
 1042              	.L70:
 1043 00c2 0020     		movs	r0, #0
 1044              	.LVL152:
 1045 00c4 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1046              		.cfi_endproc
 1047              	.LFE32:
 1049              		.section	.text.i2c_bit_xfer,"ax",%progbits
 1050              		.align	1
 1051              		.syntax unified
 1052              		.thumb
 1053              		.thumb_func
 1054              		.fpu fpv4-sp-d16
ARM GAS  /tmp/ccNhsg46.s 			page 27


 1056              	i2c_bit_xfer:
 1057              	.LFB33:
 368:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 369:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static rt_size_t i2c_bit_xfer(struct rt_i2c_bus_device *bus,
 370:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                               struct rt_i2c_msg         msgs[],
 371:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                               rt_uint32_t               num)
 372:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 1058              		.loc 1 372 0
 1059              		.cfi_startproc
 1060              		@ args = 0, pretend = 0, frame = 0
 1061              		@ frame_needed = 0, uses_anonymous_args = 0
 1062              	.LVL153:
 1063 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1064              	.LCFI11:
 1065              		.cfi_def_cfa_offset 32
 1066              		.cfi_offset 4, -32
 1067              		.cfi_offset 5, -28
 1068              		.cfi_offset 6, -24
 1069              		.cfi_offset 7, -20
 1070              		.cfi_offset 8, -16
 1071              		.cfi_offset 9, -12
 1072              		.cfi_offset 10, -8
 1073              		.cfi_offset 14, -4
 1074 0004 0646     		mov	r6, r0
 1075 0006 8846     		mov	r8, r1
 1076 0008 1746     		mov	r7, r2
 373:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_msg *msg;
 374:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     struct rt_i2c_bit_ops *ops = (struct rt_i2c_bit_ops *)bus->priv;
 1077              		.loc 1 374 0
 1078 000a D0F86090 		ldr	r9, [r0, #96]
 1079              	.LVL154:
 375:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_int32_t i, ret;
 376:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     rt_uint16_t ignore_nack;
 377:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 378:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     LOG_D("send start condition");
 379:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_start(ops);
 1080              		.loc 1 379 0
 1081 000e 4846     		mov	r0, r9
 1082              	.LVL155:
 1083 0010 FFF7FEFF 		bl	i2c_start
 1084              	.LVL156:
 380:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     for (i = 0; i < num; i++)
 1085              		.loc 1 380 0
 1086 0014 0025     		movs	r5, #0
 1087 0016 0BE0     		b	.L78
 1088              	.LVL157:
 1089              	.L79:
 381:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 382:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         msg = &msgs[i];
 383:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ignore_nack = msg->flags & RT_I2C_IGNORE_NACK;
 384:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (!(msg->flags & RT_I2C_NO_START))
 385:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 386:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (i)
 387:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 388:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 i2c_restart(ops);
 389:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 390:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             ret = i2c_bit_send_address(bus, msg);
ARM GAS  /tmp/ccNhsg46.s 			page 28


 391:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if ((ret != RT_EOK) && !ignore_nack)
 392:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 393:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 LOG_D("receive NACK from device addr 0x%02x msg %d",
 394:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                         msgs[i].addr, i);
 395:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 goto out;
 396:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 397:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 398:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (msg->flags & RT_I2C_RD)
 1090              		.loc 1 398 0
 1091 0018 6388     		ldrh	r3, [r4, #2]
 1092 001a 13F0010F 		tst	r3, #1
 1093 001e 2ED0     		beq	.L82
 399:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 400:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             ret = i2c_recv_bytes(bus, msg);
 1094              		.loc 1 400 0
 1095 0020 2146     		mov	r1, r4
 1096 0022 3046     		mov	r0, r6
 1097 0024 FFF7FEFF 		bl	i2c_recv_bytes
 1098              	.LVL158:
 401:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret >= 1)
 402:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 LOG_D("read %d byte%s", ret, ret == 1 ? "" : "s");
 403:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret < msg->len)
 1099              		.loc 1 403 0
 1100 0028 A388     		ldrh	r3, [r4, #4]
 1101 002a 9842     		cmp	r0, r3
 1102 002c 1BDB     		blt	.L89
 1103              	.L83:
 380:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 1104              		.loc 1 380 0 discriminator 2
 1105 002e 0135     		adds	r5, r5, #1
 1106              	.LVL159:
 1107              	.L78:
 380:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     {
 1108              		.loc 1 380 0 is_stmt 0 discriminator 1
 1109 0030 BD42     		cmp	r5, r7
 1110 0032 1CD2     		bcs	.L81
 382:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         ignore_nack = msg->flags & RT_I2C_IGNORE_NACK;
 1111              		.loc 1 382 0 is_stmt 1
 1112 0034 05EB4503 		add	r3, r5, r5, lsl #1
 1113 0038 9C00     		lsls	r4, r3, #2
 1114 003a 4444     		add	r4, r4, r8
 1115              	.LVL160:
 383:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         if (!(msg->flags & RT_I2C_NO_START))
 1116              		.loc 1 383 0
 1117 003c 6388     		ldrh	r3, [r4, #2]
 1118 003e 03F0200A 		and	r10, r3, #32
 1119              	.LVL161:
 384:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 1120              		.loc 1 384 0
 1121 0042 13F0100F 		tst	r3, #16
 1122 0046 E7D1     		bne	.L79
 386:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1123              		.loc 1 386 0
 1124 0048 15B1     		cbz	r5, .L80
 388:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 1125              		.loc 1 388 0
 1126 004a 4846     		mov	r0, r9
ARM GAS  /tmp/ccNhsg46.s 			page 29


 1127 004c FFF7FEFF 		bl	i2c_restart
 1128              	.LVL162:
 1129              	.L80:
 390:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if ((ret != RT_EOK) && !ignore_nack)
 1130              		.loc 1 390 0
 1131 0050 2146     		mov	r1, r4
 1132 0052 3046     		mov	r0, r6
 1133 0054 FFF7FEFF 		bl	i2c_bit_send_address
 1134              	.LVL163:
 391:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1135              		.loc 1 391 0
 1136 0058 0028     		cmp	r0, #0
 1137 005a DDD0     		beq	.L79
 391:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1138              		.loc 1 391 0 is_stmt 0 discriminator 1
 1139 005c BAF1000F 		cmp	r10, #0
 1140 0060 DAD1     		bne	.L79
 390:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if ((ret != RT_EOK) && !ignore_nack)
 1141              		.loc 1 390 0 is_stmt 1
 1142 0062 0546     		mov	r5, r0
 1143              	.LVL164:
 1144 0064 03E0     		b	.L81
 1145              	.LVL165:
 1146              	.L89:
 404:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 405:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 if (ret >= 0)
 1147              		.loc 1 405 0
 1148 0066 0028     		cmp	r0, #0
 1149 0068 07DB     		blt	.L90
 406:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     ret = -RT_EIO;
 1150              		.loc 1 406 0
 1151 006a 6FF00705 		mvn	r5, #7
 1152              	.LVL166:
 1153              	.L81:
 407:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 goto out;
 408:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 409:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 410:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         else
 411:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         {
 412:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             ret = i2c_send_bytes(bus, msg);
 413:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret >= 1)
 414:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 LOG_D("write %d byte%s", ret, ret == 1 ? "" : "s");
 415:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret < msg->len)
 416:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 417:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 if (ret >= 0)
 418:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     ret = -RT_ERROR;
 419:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 goto out;
 420:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             }
 421:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****         }
 422:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     }
 423:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     ret = i;
 424:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 425:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** out:
 426:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     LOG_D("send stop condition");
 427:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_stop(ops);
 1154              		.loc 1 427 0
 1155 006e 4846     		mov	r0, r9
ARM GAS  /tmp/ccNhsg46.s 			page 30


 1156 0070 FFF7FEFF 		bl	i2c_stop
 1157              	.LVL167:
 428:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 429:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     return ret;
 430:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 1158              		.loc 1 430 0
 1159 0074 2846     		mov	r0, r5
 1160 0076 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1161              	.LVL168:
 1162              	.L90:
 400:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret >= 1)
 1163              		.loc 1 400 0
 1164 007a 0546     		mov	r5, r0
 1165              	.LVL169:
 1166 007c F7E7     		b	.L81
 1167              	.LVL170:
 1168              	.L82:
 412:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret >= 1)
 1169              		.loc 1 412 0
 1170 007e 2146     		mov	r1, r4
 1171 0080 3046     		mov	r0, r6
 1172 0082 FFF7FEFF 		bl	i2c_send_bytes
 1173              	.LVL171:
 415:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             {
 1174              		.loc 1 415 0
 1175 0086 A388     		ldrh	r3, [r4, #4]
 1176 0088 9842     		cmp	r0, r3
 1177 008a D0DA     		bge	.L83
 417:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                     ret = -RT_ERROR;
 1178              		.loc 1 417 0
 1179 008c 0028     		cmp	r0, #0
 1180 008e 02DB     		blt	.L91
 418:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                 goto out;
 1181              		.loc 1 418 0
 1182 0090 4FF0FF35 		mov	r5, #-1
 1183              	.LVL172:
 1184 0094 EBE7     		b	.L81
 1185              	.LVL173:
 1186              	.L91:
 412:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****             if (ret >= 1)
 1187              		.loc 1 412 0
 1188 0096 0546     		mov	r5, r0
 1189              	.LVL174:
 1190 0098 E9E7     		b	.L81
 1191              		.cfi_endproc
 1192              	.LFE33:
 1194              		.section	.text.rt_i2c_bit_add_bus,"ax",%progbits
 1195              		.align	1
 1196              		.global	rt_i2c_bit_add_bus
 1197              		.syntax unified
 1198              		.thumb
 1199              		.thumb_func
 1200              		.fpu fpv4-sp-d16
 1202              	rt_i2c_bit_add_bus:
 1203              	.LFB34:
 431:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 432:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** static const struct rt_i2c_bus_device_ops i2c_bit_bus_ops =
ARM GAS  /tmp/ccNhsg46.s 			page 31


 433:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 434:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     i2c_bit_xfer,
 435:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     RT_NULL,
 436:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****     RT_NULL
 437:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** };
 438:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 439:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** rt_err_t rt_i2c_bit_add_bus(struct rt_i2c_bus_device *bus,
 440:rt-thread/components/drivers/i2c/i2c-bit-ops.c ****                             const char               *bus_name)
 441:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** {
 1204              		.loc 1 441 0
 1205              		.cfi_startproc
 1206              		@ args = 0, pretend = 0, frame = 0
 1207              		@ frame_needed = 0, uses_anonymous_args = 0
 1208              	.LVL175:
 1209 0000 08B5     		push	{r3, lr}
 1210              	.LCFI12:
 1211              		.cfi_def_cfa_offset 8
 1212              		.cfi_offset 3, -8
 1213              		.cfi_offset 14, -4
 442:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 	bus->ops = &i2c_bit_bus_ops;
 1214              		.loc 1 442 0
 1215 0002 024B     		ldr	r3, .L94
 1216 0004 C362     		str	r3, [r0, #44]
 443:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 
 444:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** 	return rt_i2c_bus_device_register(bus, bus_name);
 1217              		.loc 1 444 0
 1218 0006 FFF7FEFF 		bl	rt_i2c_bus_device_register
 1219              	.LVL176:
 445:rt-thread/components/drivers/i2c/i2c-bit-ops.c **** }
 1220              		.loc 1 445 0
 1221 000a 08BD     		pop	{r3, pc}
 1222              	.L95:
 1223              		.align	2
 1224              	.L94:
 1225 000c 00000000 		.word	.LANCHOR0
 1226              		.cfi_endproc
 1227              	.LFE34:
 1229              		.section	.rodata.i2c_bit_bus_ops,"a",%progbits
 1230              		.align	2
 1231              		.set	.LANCHOR0,. + 0
 1234              	i2c_bit_bus_ops:
 1235 0000 00000000 		.word	i2c_bit_xfer
 1236 0004 00000000 		.word	0
 1237 0008 00000000 		.word	0
 1238              		.text
 1239              	.Letext0:
 1240              		.file 2 "rt-thread/include/rtdef.h"
 1241              		.file 3 "/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/lock.h"
 1242              		.file 4 "/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/_types.h"
 1243              		.file 5 "/opt/gcc-arm-none-eabi-6-2017-q2-update/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 1244              		.file 6 "/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/reent.h"
 1245              		.file 7 "/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/time.h"
 1246              		.file 8 "/opt/gcc-arm-none-eabi-6-2017-q2-update/arm-none-eabi/include/sys/errno.h"
 1247              		.file 9 "rt-thread/components/finsh/finsh_api.h"
 1248              		.file 10 "rt-thread/components/drivers/include/drivers/i2c.h"
 1249              		.file 11 "rt-thread/components/drivers/include/drivers/i2c-bit-ops.h"
 1250              		.file 12 "rt-thread/include/rtthread.h"
ARM GAS  /tmp/ccNhsg46.s 			page 32


ARM GAS  /tmp/ccNhsg46.s 			page 33


DEFINED SYMBOLS
                            *ABS*:0000000000000000 i2c-bit-ops.c
     /tmp/ccNhsg46.s:18     .text.i2c_start:0000000000000000 $t
     /tmp/ccNhsg46.s:24     .text.i2c_start:0000000000000000 i2c_start
     /tmp/ccNhsg46.s:67     .text.SCL_H:0000000000000000 $t
     /tmp/ccNhsg46.s:73     .text.SCL_H:0000000000000000 SCL_H
     /tmp/ccNhsg46.s:149    .text.i2c_restart:0000000000000000 $t
     /tmp/ccNhsg46.s:155    .text.i2c_restart:0000000000000000 i2c_restart
     /tmp/ccNhsg46.s:218    .text.i2c_writeb:0000000000000000 $t
     /tmp/ccNhsg46.s:224    .text.i2c_writeb:0000000000000000 i2c_writeb
     /tmp/ccNhsg46.s:369    .text.i2c_send_bytes:0000000000000000 $t
     /tmp/ccNhsg46.s:375    .text.i2c_send_bytes:0000000000000000 i2c_send_bytes
     /tmp/ccNhsg46.s:456    .text.i2c_readb:0000000000000000 $t
     /tmp/ccNhsg46.s:462    .text.i2c_readb:0000000000000000 i2c_readb
     /tmp/ccNhsg46.s:565    .text.i2c_send_ack_or_nack:0000000000000000 $t
     /tmp/ccNhsg46.s:571    .text.i2c_send_ack_or_nack:0000000000000000 i2c_send_ack_or_nack
     /tmp/ccNhsg46.s:636    .text.i2c_recv_bytes:0000000000000000 $t
     /tmp/ccNhsg46.s:642    .text.i2c_recv_bytes:0000000000000000 i2c_recv_bytes
     /tmp/ccNhsg46.s:716    .text.i2c_stop:0000000000000000 $t
     /tmp/ccNhsg46.s:722    .text.i2c_stop:0000000000000000 i2c_stop
     /tmp/ccNhsg46.s:788    .text.i2c_send_address:0000000000000000 $t
     /tmp/ccNhsg46.s:794    .text.i2c_send_address:0000000000000000 i2c_send_address
     /tmp/ccNhsg46.s:870    .text.i2c_bit_send_address:0000000000000000 $t
     /tmp/ccNhsg46.s:876    .text.i2c_bit_send_address:0000000000000000 i2c_bit_send_address
     /tmp/ccNhsg46.s:1050   .text.i2c_bit_xfer:0000000000000000 $t
     /tmp/ccNhsg46.s:1056   .text.i2c_bit_xfer:0000000000000000 i2c_bit_xfer
     /tmp/ccNhsg46.s:1195   .text.rt_i2c_bit_add_bus:0000000000000000 $t
     /tmp/ccNhsg46.s:1202   .text.rt_i2c_bit_add_bus:0000000000000000 rt_i2c_bit_add_bus
     /tmp/ccNhsg46.s:1225   .text.rt_i2c_bit_add_bus:000000000000000c $d
     /tmp/ccNhsg46.s:1230   .rodata.i2c_bit_bus_ops:0000000000000000 $d
     /tmp/ccNhsg46.s:1234   .rodata.i2c_bit_bus_ops:0000000000000000 i2c_bit_bus_ops
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
rt_tick_get
rt_thread_delay
rt_i2c_bus_device_register
